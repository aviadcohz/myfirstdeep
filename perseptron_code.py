import numpy as np
import matplotlib
import matplotlib.pyplot as plt
import time

def dotProduct(vec1, vec2):
    return sum(vec1val * vec2val for vec1val, vec2val in zip(vec1, vec2))
##    sum(map( operator.mul, vector1, vector2))

def getWeight(xy):
    tryRounds=0
    threshold = 0.5
    learning_rate = 0.1
    #we will initiate the w to be 0 vector, at the same size of X
    w = [0 for x in xrange(len(xy[0][0]))]
    while True:
    ##    print('-' * 60)
        error_count = 0
        for input_vector, desired_output in xy:
    ##        print(w)
    ##        print tryRounds
            tryRounds+=1
            result = dotProduct(input_vector, w) > threshold
            error = desired_output - result
            if error != 0:
                error_count += 1
                for index, value in enumerate(input_vector):
                    w[index] += learning_rate * error * value
        if error_count == 0:
            break
##    print 'it took ',tryRounds,' to find the right w'
##    print ('the weight results are:')
##    print(w)
    return w

def checkResults(w,x,y):
    threshold = 0.5
    result=[]
    rightCount=0
    for sample in x:
        rightWrong = dotProduct(sample, w) > threshold
        result.append(rightWrong)
##    print len(y),len(result)
    for i in range(len(y)):
        if result[i]==y[i]:
            rightCount+=1
##        else:
##            print 'error at line',i
##            printARow(x[i])
##            time.sleep(1)
    print 'we are right with ',100.0*rightCount/len(y),'%'

# a row with 28^2 pixs
def printARow(rowToPrint):
    matplotlib.interactive(True)
    matplotlib.use("TKAgg")
    plt.imshow(rowToPrint.reshape(28,28),cmap="gray");
    plt.draw();

##X = np.loadtxt("train4vs7_data.txt.gz");
##Y = np.loadtxt( "train4vs7_labels.txt.gz");
##X = np.loadtxt("xtry.txt");
##Y = np.loadtxt("ytry.txt");
#no need of bias
X = np.loadtxt("Xtrain.txt");
Y = np.loadtxt("Ytrain.txt");
Y=[0 if x==-1 else x for x in Y]


#no need of bias
##bias=np.ones(len(X))
##xy=np.c_[bias,X]
xy=X
#connecting X and Y to be at the same row, first the X data vector then the Y result
xy = [[xy[i]] + [Y [i]] for i in range(len(xy))]
##print xy
##exit(0)
##xy=[] #this will be x and then a column of y
##for row in range (len(X)):
##    xy.append([X[row]]+[Y[row]])
##print xy
##xy = [[[1, 0, 0], 1], [[1, 0, 1], 1], [[1, 1, 0], 1], [[1, 1, 1], 0]]
##print xy

print ('training the weights, can take about 1 minute')
w=getWeight(xy)
print ('weight are',w)


##w=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.014509803921568601, 0.062745098039215699, 0.10000000000000001, 0.043921568627451002, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0090196078431372603, 0.088627450980392208, 0.098431372549019611, 0.0062745098039215701, 0.0, 0.0, 0.0, -0.18039215686274521, -0.39843137254901961, -0.38705882352941179, -0.29607843137254902, -0.065490196078431595, 0.096078431372549067, 0.19960784313725491, 0.21921568627450982, 0.1741176470588236, 0.19960784313725491, 0.10549019607843138, 0.068627450980392204, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0152941176470588, 0.0023529411764705993, -0.062352941176470666, -0.45176470588235296, -0.48039215686274506, -0.11294117647058827, -0.016078431372548923, -0.21450980392156876, -0.037647058823529554, -0.57803921568627381, -0.36627450980392251, -0.52784313725490195, -0.93686274509803935, -0.47098039215686277, -0.14470588235294116, -0.20274509803921556, 0.11529411764705862, 0.11098039215686258, 0.2203921568627451, 0.10745098039215686, 0.099215686274509801, 0.018431372549019602, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.023921568627450943, -0.070196078431372516, -0.14392156862745101, -0.26470588235294124, -0.32078431372549021, -0.18196078431372575, -0.021960784313725716, 0.078431372549019551, 0.12980392156862794, -0.41803921568627395, -0.50862745098039308, -0.4270588235294116, 0.25411764705882378, 0.011372549019607617, 0.1396078431372558, -0.15921568627450927, -0.35294117647058842, 0.074117647058823788, 0.54313725490196074, 0.42509803921568634, 0.10745098039215686, 0.044705882352941206, 0.0, 0.0, 0.0, 0.0, 0.0, -0.10000000000000001, -0.11098039215686273, -0.14117647058823535, -0.28784313725490196, -0.40352941176470636, -0.8713725490196077, -0.70235294117647029, -0.71372549019607845, -0.60549019607843124, -0.20392156862745167, -0.12078431372549023, 0.11333333333333337, -0.71921568627451005, -0.13176470588235284, -0.35529411764705904, 0.27529411764705902, 0.18313725490196056, -0.15960784313725504, 0.059607843137254556, 0.48862745098039234, 0.51490196078431383, 0.1494117647058823, 0.0023529411764705902, 0.0, 0.0, 0.0, 0.0, 0.0, -0.099215686274509801, -0.13137254901960785, -0.24196078431372503, -0.44352941176470556, -0.25921568627450892, -0.7490196078431377, -1.1066666666666662, -1.0196078431372555, -0.7858823529411777, -0.77529411764705924, -1.349411764705881, -1.1207843137254894, -1.318431372549018, -0.80196078431372608, -0.0094117647058812731, -0.46862745098039171, -0.61137254901960869, -0.038039215686274337, 0.14862745098039204, 0.13843137254901966, 0.16862745098039222, 0.12862745098039219, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.14039215686274509, -0.54980392156862745, -0.62000000000000011, -0.53215686274509832, -0.0086274509803924287, 0.16627450980392122, -0.021176470588234936, -0.36039215686274484, 0.00313725490196122, -0.36196078431372625, -0.834901960784314, -1.4772549019607857, -1.2290196078431368, -0.4992156862745093, -0.34470588235294131, -0.25607843137254921, -0.37137254901960892, -0.071764705882352758, -0.34549019607843201, -0.10784313725490201, -0.0058823529411766058, 0.040392156862745103, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.32784313725490188, -0.99137254901960759, -0.65647058823529414, -0.45333333333333309, -0.30352941176470588, 0.010588235294117274, -0.074509803921569334, -0.29529411764705882, 0.12470588235294136, 0.1996078431372551, -0.36941176470588249, -1.3364705882352952, -0.84666666666666801, -0.57568627450980359, -0.59960784313725513, -0.85764705882352898, -0.11843137254901984, -0.50549019607843115, -0.27960784313725484, -0.31215686274509813, -0.15647058823529425, 0.016470588235294101, 0.0, 0.0, 0.0, 0.0, 0.0, -0.11411764705882352, -0.31294117647058822, -0.4827450980392155, -0.19647058823529429, 0.04274509803921555, -0.30705882352941172, 0.064313725490196164, -0.0074509803921563034, 0.075294117647059011, -0.21215686274509862, -0.22039215686274438, -0.82039215686274458, -1.6792156862745111, -0.13137254901960782, -0.03450980392156848, -0.59803921568627472, -0.98117647058823654, 0.11568627450980429, -0.38980392156862742, -0.16274509803921566, -0.31882352941176484, -0.0870588235294118, 0.045882352941176506, 0.0, 0.0, 0.0, 0.0, -0.26352941176470601, -0.29882352941176471, -0.29882352941176471, -0.50196078431372559, -0.04901960784313731, 0.62666666666666648, 0.59803921568627472, 0.82196078431372521, 0.70588235294117618, 0.95294117647058818, 0.92627450980392156, 1.2733333333333334, 0.18235294117647069, -0.49568627450980374, 0.2843137254901964, 0.18823529411764744, -0.50862745098039208, 0.21490196078431403, 0.61450980392156906, 0.014509803921568774, -0.045490196078431189, -0.2121568627450981, -0.03137254901960787, 0.026666666666666634, 0.0, 0.0, 0.0, 0.0, -0.1211764705882353, -0.19882352941176482, -0.26980392156862754, -0.1784313725490197, 0.039215686274509741, 0.58274509803921515, 1.1501960784313723, 1.3305882352941172, 0.69764705882352951, 0.91176470588235214, 1.2784313725490195, 1.6615686274509807, 1.2898039215686277, 0.80196078431372531, 0.4211764705882356, 0.7815686274509811, 0.87176470588235311, 0.44235294117646989, 0.51882352941176479, 0.26274509803921575, 0.23607843137254922, -0.018431372549019567, -0.074117647058823607, -0.090980392156862711, -0.055294117647058806, 0.0, 0.0, 0.0, 0.0, -0.067450980392156898, -0.12431372549019606, -0.11411764705882373, 0.36666666666666664, 0.53803921568627455, 0.46235294117647036, 0.41764705882352904, 0.63803921568627442, 0.4431372549019601, 0.57764705882352863, 0.58941176470588186, 1.0988235294117645, 0.44431372549019527, 0.82901960784313677, 0.9254901960784323, 0.72352941176470575, -0.52274509803921676, -0.30980392156862757, -0.53098039215686299, -0.16313725490196113, -0.28352941176470631, -0.0086274509803921547, 0.0047058823529411986, -0.0098039215686274508, 0.0, 0.0, 0.0, 0.0, -0.079607843137254899, -0.087843137254902004, -0.065882352941176503, 0.49686274509803957, 0.13058823529411798, -0.13764705882352912, 0.57960784313725511, 0.52980392156862743, 0.65137254901960806, 0.56784313725490265, 0.45725490196078411, 0.68313725490196098, 0.70941176470588374, 0.78117647058823469, 0.65490196078431417, -0.2290196078431373, -0.41725490196078435, -0.2556862745098043, -0.52352941176470646, -0.062352941176470694, 0.0019607843137258718, -0.16078431372549001, -0.035686274509803932, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.049411764705882363, 0.34980392156862755, 0.31803921568627413, -0.021568627450980545, -0.13490196078431388, 0.016078431372548802, 0.1305882352941167, -0.12980392156862716, 0.15215686274509713, 1.188627450980392, 0.93215686274509757, 0.82352941176470529, 0.56509803921568591, 0.19803921568627486, -0.14196078431372558, 0.1454901960784318, -0.053333333333333593, -0.31843137254901982, -0.23254901960784374, 0.089803921568627987, -0.08549019607843153, 0.00078431372549033623, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.076862745098039198, 0.21215686274509787, 0.10901960784313713, 0.026274509803921747, 0.27803921568627465, 0.8215686274509798, 0.64274509803921531, 0.63568627450980386, 0.8141176470588235, 0.81764705882352795, 0.50431372549019604, 0.82431372549019666, 0.64509803921568565, 0.21137254901960745, 0.223921568627451, 0.27843137254901912, 0.10039215686274479, 0.042352941176470649, 0.11921568627450983, 0.21490196078431359, 0.31058823529411761, 0.09411764705882357, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07411764705882351, 0.15686274509803913, 0.14078431372549016, 0.30274509803921573, 0.42117647058823549, 0.41725490196078419, 0.13843137254901935, 0.042352941176470468, 0.04117647058823537, 0.19568627450980325, 0.42862745098039257, 0.23568627450980451, -0.15098039215686232, -0.18156862745098107, 0.25764705882352867, 0.16117647058823542, -0.223529411764706, 0.12000000000000011, 0.33411764705882363, 0.10666666666666655, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.090980392156862808, 0.17764705882352941, -0.16431372549019624, -0.34509803921568627, -0.36392156862745095, -0.49058823529411766, -0.36313725490196069, -0.2290196078431368, -0.18039215686274562, 0.35843137254902019, -0.035686274509804307, 0.12078431372549051, -0.06117647058823434, -0.24705882352941183, 0.049411764705882273, -0.16392156862745114, -0.059607843137254923, -0.042745098039215654, 0.10392156862745097, 0.017254901960784365, -0.021960784313725501, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.082745098039215731, 0.011372549019607884, -0.23137254901960783, -0.23137254901960783, -0.32117647058823534, -0.41176470588235281, -0.33019607843137333, -0.36274509803921584, -0.2639215686274507, -0.4870588235294121, -0.42078431372548997, 0.30549019607843092, 0.12823529411764781, -0.32666666666666627, 0.24274509803921596, 0.15607843137254909, 0.19019607843137259, 0.13215686274509811, 0.07333333333333332, -0.022745098039215594, -0.064313725490196108, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.054509803921568609, -0.023921568627450998, -0.0423529411764706, -0.076078431372548994, -0.22941176470588232, -0.35764705882352926, -0.35254901960784341, -0.50274509803921585, -0.70196078431372588, -0.32627450980392081, -0.037647058823529159, 0.15843137254901951, 0.23568627450980445, -0.44196078431372549, 0.15647058823529436, 0.21058823529411749, 0.31529411764705889, 0.13725490196078438, 0.12117647058823532, 0.036862745098039308, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.12705882352941181, -0.172156862745098, -0.1929411764705882, -0.26078431372549016, -0.35999999999999999, -0.44627450980392147, -0.28666666666666757, -0.72313725490196079, -0.48470588235294065, -0.19568627450980375, 0.00039215686274531036, -0.049019607843137115, -0.10627450980392118, -0.26941176470588274, 0.23019607843137263, 0.25294117647058811, 0.31372549019607848, 0.18745098039215691, 0.172156862745098, 0.074901960784313701, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.031764705882352903, -0.1419607843137255, -0.1929411764705882, -0.20235294117647057, -0.34156862745098043, -0.39294117647058807, -0.80000000000000016, -0.30784313725490192, -0.76980392156862698, -0.52745098039215721, -0.22078431372548979, -0.17843137254901995, -0.82117647058823573, -0.17137254901960761, 0.077254901960783981, 0.2752941176470588, 0.18941176470588236, 0.29294117647058826, 0.17607843137254908, 0.13607843137254902, 0.10000000000000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.0168627450980392, -0.089019607843137311, -0.12235294117647058, -0.13215686274509811, -0.16941176470588235, -0.34156862745098043, -0.55999999999999994, -0.53019607843137262, -0.52196078431372506, -0.36745098039215751, -0.14745098039215701, 0.036470588235293658, -0.7007843137254901, 0.18156862745098021, 0.13019607843137232, 0.28588235294117631, -0.012156862745098102, 0.056078431372548962, 0.04117647058823528, 0.074901960784313701, 0.050196078431372609, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.033333333333333298, -0.1188235294117647, -0.19372549019607838, -0.46823529411764708, -0.47529411764705881, -0.011764705882352497, -0.22392156862745125, -0.23450980392156873, -0.63058823529411767, -0.82313725490196077, -0.86941176470588222, -0.62078431372549037, -0.46862745098039238, 0.06627450980392148, -0.057647058823529426, -0.034509803921568639, -0.0023529411764705902, 0.025098039215686305, 0.025098039215686305, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.10549019607843141, -0.29764705882352938, -0.4137254901960784, -0.53529411764705892, -0.35921568627450978, -0.61882352941176477, -1.0113725490196079, -0.84156862745098038, -0.39921568627450998, -0.18431372549019601, -0.14196078431372552, -0.1105882352941176, -0.045882352941176506, -0.0043137254901960799, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.045490196078431404, -0.16901960784313719, -0.14156862745098042, -0.074901960784313701, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

print ('now we will test our results')
X = np.loadtxt("Xtest.txt");
Y = np.loadtxt("Ytest.txt");
Y=[False if x==-1 else True for x in Y]
checkResults(w,X,Y)
exit(0)
##for watching the w results we can do something like this:
maxi=max(w)
w=(w+maxi)/maxi
printARow(w)

exit(0)









print ('hello')
import numpy as np
##X = np.loadtxt("train4vs7_data.txt.gz");
##Y = np.loadtxt( "train4vs7_labels.txt.gz");
X = np.loadtxt("Xtrain.txt");
Y = np.loadtxt( "Ytrain.txt");
c=1
z=X[1,:]
print z
##exit(0)
a=[z]+[c]
print a
print a[0]
print a[0][0]
print a[1]
exit(0)

##print len(X[0])
##len(Y)
print X[0]

print ('hello2')

import matplotlib
import matplotlib.pyplot as plt
matplotlib.interactive(True)
matplotlib.use("TKAgg")
plt.imshow(X[1,:].reshape(28,28),cmap="gray");
plt.draw();